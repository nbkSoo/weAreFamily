<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1,user-scalable=no"/>
    <link rel="stylesheet" href="css/chongzhi.css">
    <link rel="stylesheet" href="css/zhuce.css">
    <script src="js/app.js"></script>
</head>
<body>
<main>
    <div class="header">注册</div>
</main>
<section>
    <ul>
        <li>
            <div class="nicheng">昵&nbsp;&nbsp;称</div>
            <input type="text" placeholder="请输入昵称" class="inp inpa">
        </li>
        <li>
            <div class="nicheng">手机号</div>
            <input type="tel" pattern="^(13|15|18|17|16)\d{9}$" placeholder="请输入手机号" class="inp register_tel inpb">
        </li>
        <li>
            <div class="nicheng">验证码</div>
            <input type="text" placeholder="请输入验证码" class="inp1">
            <input type="button" value="获取验证码" class="inp2">
        </li>
        <li>
            <div class="nicheng">密&nbsp;&nbsp;码</div>
            <input type="password" placeholder="请输入密码" class="inp inpc">
        </li>
        <li>
            <div class="nicheng">确认密码</div>
            <input type="password" placeholder="请确认密码" class="inp inpd">
        </li>
        <li>
            <input type="button" value="注册" class="btn">
        </li>
    </ul>
</section>
<script src="js/jquery-3.2.1.min.js"></script>
<script>
    var $tel = $(".register_tel");
    var s = 60;
    var timer = null;
    $(".inp2").on("click",function(){
        if($tel.val()==""){
            alert("手机号不能为空！");
            return;
        }else if($tel[0].validity.patternMismatch){
            alert("手机号码格式错误");
        }else{
            timer = setInterval(downTime,1000);
            $(this).addClass("notClick");
            function downTime() {
                s--;
                $(".inp2").val(s+"秒后重新获取");
                if(s<=0){
                    clearInterval(timer);
                    $(".inp2").val("获取验证码").removeClass("notClick");
                    s = 60;
                }
            }
            var rand = Math.floor(Math.random()*899999+100000);
            $.ajax({
                type:"post",
                url:"http://172.16.45.87/PhpstormProjects/weAreFamily11/php/aliyun/api_demo/SmsDemo.php",
                data:"tel="+$tel.val()+"&rand="+rand,
                dataType:"json",
                success:function (data) {
                    console.log(data);
                }
            })
        }







    })


    var div='<div class="yincang"></div>';
    $("li").append(div);
    // 昵称
    $(".inpa").on("blur",function () {
        var reg=/^((\w)|.*[\u4e00-\u9fa5].*)((\w)|.*[\u4e00-\u9fa5].*){1,9}$/;
        if($(".inpa").val()==""){
            $("li:eq(0)").children(".yincang").html("内容不能为空");
        }else if($(".inpa").val().length<3){
            $("li:eq(0)").children(".yincang").html("请输入3~10位有效字符");
        }
    });
    // 密码
    $(".inpc").on("blur",function () {
        if($(".inpc").val()==""){
            $("li:eq(3)").children(".yincang").html("密码不能为空");
        }else if($(".inpc").val().length<6){
            $("li:eq(3)").children(".yincang").html("密码长度为6~20个字符");
        }else{
            var level=0;
            if(/[a-z]/.test($(".inpc").val())){
                level++;
            }
            if(/[0-9]/.test($(".inpc").val())){
                level++;
            }
            if(/[^0-9 a-z]/.test($(".inpc").val())){
                level++;
            }
        }
    });
</script>
</body>
</html>